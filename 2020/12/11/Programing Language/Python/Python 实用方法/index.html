<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"snowyang.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="一些 Python 的实用方法整理。">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 实用方法">
<meta property="og:url" content="https://snowyang.com/2020/12/11/Programing%20Language/Python/Python%20%E5%AE%9E%E7%94%A8%E6%96%B9%E6%B3%95/index.html">
<meta property="og:site_name" content="冷香小筑">
<meta property="og:description" content="一些 Python 的实用方法整理。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-12-11T12:01:32.364Z">
<meta property="article:modified_time" content="2020-12-11T12:01:32.364Z">
<meta property="article:author" content="Snow Yang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://snowyang.com/2020/12/11/Programing%20Language/Python/Python%20%E5%AE%9E%E7%94%A8%E6%96%B9%E6%B3%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Python 实用方法 | 冷香小筑</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c946d75c051cf3fd9b2873d44f7a553e";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">冷香小筑</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Snow Yang 的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://snowyang.com/2020/12/11/Programing%20Language/Python/Python%20%E5%AE%9E%E7%94%A8%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Snow Yang">
      <meta itemprop="description" content="千古风流今在此，万里功名莫放休">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冷香小筑">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python 实用方法
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-11 20:01:32" itemprop="dateCreated datePublished" datetime="2020-12-11T20:01:32+08:00">2020-12-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
            <span id="/2020/12/11/Programing%20Language/Python/Python%20%E5%AE%9E%E7%94%A8%E6%96%B9%E6%B3%95/" class="post-meta-item leancloud_visitors" data-flag-title="Python 实用方法" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>一些 Python 的实用方法整理。</p>
<a id="more"></a>

<h2 id="各种格式转换"><a href="#各种格式转换" class="headerlink" title="各种格式转换"></a>各种格式转换</h2><h3 id="39-0102-39-to-b-39-x01-x02-39"><a href="#39-0102-39-to-b-39-x01-x02-39" class="headerlink" title="&#39;0102&#39;  to  b&#39;\x01\x02&#39;"></a><code>&#39;0102&#39;</code>  to  <code>b&#39;\x01\x02&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bytes.fromhex(&#39;0102&#39;)</span><br><span class="line">b&#39;\x01\x02&#39;</span><br></pre></td></tr></table></figure>

<h3 id="b-39-x01-x02-39-to-39-0102-39"><a href="#b-39-x01-x02-39-to-39-0102-39" class="headerlink" title="b&#39;\x01\x02&#39; to &#39;0102&#39;"></a><code>b&#39;\x01\x02&#39;</code> to <code>&#39;0102&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b&#39;\x01\x02&#39;.hex()</span><br><span class="line">&#39;0102&#39;</span><br></pre></td></tr></table></figure>

<h3 id="b-39-x01-x02-39-to-1-2"><a href="#b-39-x01-x02-39-to-1-2" class="headerlink" title="b&#39;\x01\x02&#39; to [1, 2]"></a><code>b&#39;\x01\x02&#39;</code> to <code>[1, 2]</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; list(b&#39;\x01\x02&#39;)</span><br><span class="line">[1, 2]</span><br></pre></td></tr></table></figure>

<h3 id="1-2-to-b-39-x01-x02-39"><a href="#1-2-to-b-39-x01-x02-39" class="headerlink" title="[1, 2] to b&#39;\x01\x02&#39;"></a><code>[1, 2]</code> to <code>b&#39;\x01\x02&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bytes([1, 2])</span><br><span class="line">b&#39;\x01\x02&#39;</span><br></pre></td></tr></table></figure>

<h3 id="b-39-x31-x32-39-to-39-12-39"><a href="#b-39-x31-x32-39-to-39-12-39" class="headerlink" title="b&#39;\x31\x32&#39; to &#39;12&#39;"></a><code>b&#39;\x31\x32&#39;</code> to <code>&#39;12&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; b&#39;\x31\x32&#39;.decode()</span><br><span class="line">&#39;12&#39;</span><br></pre></td></tr></table></figure>

<h3 id="39-12-39-to-b-39-x31-x32-39"><a href="#39-12-39-to-b-39-x31-x32-39" class="headerlink" title="&#39;12&#39; to b&#39;\x31\x32&#39;"></a><code>&#39;12&#39;</code> to <code>b&#39;\x31\x32&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#39;12&#39;.encode()</span><br><span class="line">b&#39;\x31\x32&#39;</span><br></pre></td></tr></table></figure>

<h3 id="0x1234-to-b-39-x12-x34-39"><a href="#0x1234-to-b-39-x12-x34-39" class="headerlink" title="0x1234 to b&#39;\x12\x34&#39;"></a><code>0x1234</code> to <code>b&#39;\x12\x34&#39;</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; struct.pack(&#39;&gt;H&#39;,0x1234)</span><br><span class="line">b&#39;\x12\x34&#39;</span><br></pre></td></tr></table></figure>

<p>或者（推荐）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; 0x1234</span><br><span class="line">a.to_bytes(2, &#39;big)</span><br></pre></td></tr></table></figure>

<h3 id="b-39-x12-x34-39-to-0x1234"><a href="#b-39-x12-x34-39-to-0x1234" class="headerlink" title="b&#39;\x12\x34&#39; to 0x1234"></a><code>b&#39;\x12\x34&#39;</code> to <code>0x1234</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; struct.unpack(&#39;&gt;H&#39;, b&#39;\x12\x34&#39;)</span><br><span class="line">(4660,)</span><br></pre></td></tr></table></figure>

<p>或者（推荐）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int.from_bytes(b&#39;\x12\x34&#39;, &#39;big&#39;)</span><br></pre></td></tr></table></figure>

<h2 id="中文字符导致的错误"><a href="#中文字符导致的错误" class="headerlink" title="中文字符导致的错误"></a>中文字符导致的错误</h2><p>Python 文件中若存在中文字符，在执行过程会报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SyntaxError: Non-ASCII character &#39;\xe4&#39; in file test.py on line 2, but no encoding declared;</span><br></pre></td></tr></table></figure>

<p>Python中默认的编码格式是 ASCII 格式，在没修改编码格式时无法正确打印汉字，所以在读取中文时会报错。</p>
<p>解决方法为只要在文件开头加入<code># -*- coding: UTF-8 —</code>或者<code>#coding=utf-8</code>就行了。</p>
<h2 id="获取命令行执行结果（成功-失败）"><a href="#获取命令行执行结果（成功-失败）" class="headerlink" title="获取命令行执行结果（成功/失败）"></a>获取命令行执行结果（成功/失败）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">proc &#x3D; subprocess.Popen(&#39;ps aux&#39;, shell&#x3D;True, stdout&#x3D;subprocess.PIPE)</span><br><span class="line">ret &#x3D; proc.wait()</span><br><span class="line">print(ret)</span><br></pre></td></tr></table></figure>

<p>proc.wait() 返回 0 代表成功，返回 1 代表失败</p>
<hr>
<p>2018-04-06 更新</p>
<h3 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h3><p>关于 wait，官网文档描述如下：</p>
<blockquote>
<p>Popen.wait(<em>timeout=None</em>)</p>
<p>Wait for child process to terminate. Set and return <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.Popen.returncode"><code>returncode</code></a> attribute.</p>
<p>If the process does not terminate after <em>timeout</em> seconds, raise a <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.TimeoutExpired"><code>TimeoutExpired</code></a> exception. It is safe to catch this exception and retry the wait.</p>
<blockquote>
<p>Note</p>
<p>This will deadlock when using <code>stdout=PIPE</code> or <code>stderr=PIPE</code> and the child process generates enough output to a pipe such that it blocks waiting for the OS pipe buffer to accept more data. Use <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.Popen.communicate"><code>Popen.communicate()</code></a> when using pipes to avoid that.</p>
</blockquote>
<blockquote>
<p>Note</p>
<p>The function is implemented using a busy loop (non-blocking call and short sleeps). Use the <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/asyncio.html#module-asyncio"><code>asyncio</code></a> module for an asynchronous wait: see <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/asyncio-subprocess.html#asyncio.create_subprocess_exec"><code>asyncio.create_subprocess_exec</code></a>.</p>
</blockquote>
</blockquote>
<p>也就是说，在 stdout/err 定向到 PIPE 后，若子进程的输出超过了 PIPE 大小，那么就会死等 PIPE 被读取，而此时我们的进程又在 wait 内轮询死等子进程结束，所以就造成了死锁。</p>
<p>wait 其实是频繁的轮询子进程结果，等于：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">while proc.poll() !&#x3D; None:</span><br><span class="line">	sleep(0.0001)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/guogaoan/article/details/37034565">https://blog.csdn.net/guogaoan/article/details/37034565</a></p>
<blockquote>
<p>那死锁问题如何避免呢？官方文档里推荐使用 <code>Popen.communicate()</code>。这个方法会把输出放在内存，而不是管道里，所以这时候上限就和内存大小有关了，一般不会有问题。而且如果要获得程序返回值，可以在调用 <code>Popen.communicate()</code> 之后取 <code>Popen.returncode</code> 的值。</p>
<p>结论：如果使用 <code>subprocess.Popen</code>，就不使用 <code>Popen.wait()</code>，而使用 <code>Popen.communicate()</code> 来等待外部程序执行结束。</p>
</blockquote>
<p>wait() 方式来获取结果有个很大的问题，stdout PIPE buffer是 64K，就是当子进程打印超过时就会卡住，此时死锁就产生了，导致 wait() 始终等不到结果，所以用 communicate 最稳妥。</p>
<p>当然，如果不定向 stdou 到 PIPE，死锁就不会发生。</p>
<h3 id="读取stdout"><a href="#读取stdout" class="headerlink" title="读取stdout"></a>读取stdout</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p &#x3D; subprocess.Popen(&quot;dir&quot;, shell&#x3D;True, stdout&#x3D;subprocess.PIPE, stderr&#x3D;subprocess.STDOUT)</span><br><span class="line">while True:</span><br><span class="line">    buff &#x3D; p.stdout.readline()</span><br><span class="line">    if buff &#x3D;&#x3D; &#39;&#39; and p.poll() !&#x3D; None:</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<h3 id="stdout-缓冲问题"><a href="#stdout-缓冲问题" class="headerlink" title="stdout 缓冲问题"></a>stdout 缓冲问题</h3><p>2018-04-08 更新</p>
<p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_4513dde60100oql9.html">http://blog.sina.com.cn/s/blog_4513dde60100oql9.html</a></p>
<p>PP3E上说过这个问题，说一个程序如果不是以交互的方式运行的话，那么stdout这些都是完全缓冲的，即使设置bufsize也没用，可行的办法是使用pty或者在源码中使用fflush强制flush stdout。</p>
<p>2018-06-24 更新</p>
<p>使用 setbuf 函数关闭 stdout 缓冲区，即可实时输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setbuf(stdout, NULL);</span><br></pre></td></tr></table></figure>

<h2 id="subprocess-Popen-命令类型详解"><a href="#subprocess-Popen-命令类型详解" class="headerlink" title="subprocess.Popen 命令类型详解"></a>subprocess.Popen 命令类型详解</h2><p>参考：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/zhoug2020/p/5079407.html">python中的subprocess.Popen使用</a></p>
<p>subprocess模块定义了一个类： Popen</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class subprocess.Popen( args, </span><br><span class="line">      bufsize&#x3D;0, </span><br><span class="line">      executable&#x3D;None,</span><br><span class="line">      stdin&#x3D;None,</span><br><span class="line">      stdout&#x3D;None, </span><br><span class="line">      stderr&#x3D;None, </span><br><span class="line">      preexec_fn&#x3D;None, </span><br><span class="line">      close_fds&#x3D;False, </span><br><span class="line">      shell&#x3D;False, </span><br><span class="line">      cwd&#x3D;None, </span><br><span class="line">      env&#x3D;None, </span><br><span class="line">      universal_newlines&#x3D;False, </span><br><span class="line">      startupinfo&#x3D;None, </span><br><span class="line">      creationflags&#x3D;0)</span><br></pre></td></tr></table></figure>

<p>args参数。可以是一个字符串，可以是一个包含程序参数的列表。要执行的程序一般就是这个列表的第一项，或者是字符串本身。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subprocess.Popen([&quot;cat&quot;,&quot;test.txt&quot;])</span><br><span class="line">subprocess.Popen(&quot;cat test.txt&quot;)</span><br></pre></td></tr></table></figure>

<p>这两个之中，后者将不会工作。因为如果是一个字符串的话，必须是程序的路径才可以。(考虑unix的api函数exec，接受的是字符串<br>列表)</p>
<p>但是下面的可以工作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subprocess.Popen(&quot;cat test.txt&quot;, shell&#x3D;True)</span><br></pre></td></tr></table></figure>

<p>这是因为它相当于<br>subprocess.Popen([“/bin/sh”, “-c”, “cat test.txt”])<br>在*nix下，当shell=False（默认）时，Popen使用os.execvp()来执行子程序。args一般要是一个【列表】。如果args是个字符串的<br>话，会被当做是可执行文件的路径，这样就不能传入任何参数了。</p>
<p>在Windows下，下面的却又是可以工作的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subprocess.Popen([&quot;notepad.exe&quot;, &quot;test.txt&quot;])</span><br><span class="line">subprocess.Popen(&quot;notepad.exe test.txt&quot;)</span><br></pre></td></tr></table></figure>

<p>这是由于windows下的api函数CreateProcess接受的是一个字符串。即使是列表形式的参数，也需要先合并成字符串再传递给api函数<br><code>subprocess.Popen(&quot;notepad.exe test.txt&quot; shell=True)</code><br>等同于<br><code>subprocess.Popen(&quot;cmd.exe /C &quot;+&quot;notepad.exe test.txt&quot; shell=True</code></p>
<h2 id="subprocess-run"><a href="#subprocess-run" class="headerlink" title="subprocess.run"></a>subprocess.run</h2><p>官方推荐尽量使用 run 方法，如果需要更底层的才使用 Popen</p>
<p><a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.run">https://docs.python.org/3.5/library/subprocess.html#subprocess.run</a></p>
<blockquote>
<p>The recommended approach to invoking subprocesses is to use the <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.run"><code>run()</code></a> function for all use cases it can handle. For more advanced use cases, the underlying <a target="_blank" rel="noopener" href="https://docs.python.org/3.5/library/subprocess.html#subprocess.Popen"><code>Popen</code></a> interface can be used directly.</p>
</blockquote>
<p>其实 run 是对 Popen 和 communicate 以及结果检查的封装</p>
<h2 id="遍历文件夹-os-walk"><a href="#遍历文件夹-os-walk" class="headerlink" title="遍历文件夹 - os.walk"></a>遍历文件夹 - os.walk</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for (root,dirs,files) in os.walk(&#39;firmware&#39;):</span><br><span class="line">	print(root, dirs, files)</span><br></pre></td></tr></table></figure>

<h2 id="使用国内源来-pip-install"><a href="#使用国内源来-pip-install" class="headerlink" title="使用国内源来 pip install"></a>使用国内源来 pip install</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/microman/p/6107879.html">https://www.cnblogs.com/microman/p/6107879.html</a></p>
<p>pip install 默认使用国外源来安装库，但有时奇慢无比，切换到国内源会快很多。</p>
<p>国内源：</p>
<p>新版ubuntu要求使用https源，要注意。</p>
<p>清华：<a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a></p>
<p>阿里云：<a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/pypi/simple/">http://mirrors.aliyun.com/pypi/simple/</a></p>
<p>中国科技大学 <a target="_blank" rel="noopener" href="https://pypi.mirrors.ustc.edu.cn/simple/">https://pypi.mirrors.ustc.edu.cn/simple/</a></p>
<p>华中理工大学：<a target="_blank" rel="noopener" href="http://pypi.hustunique.com/">http://pypi.hustunique.com/</a></p>
<p>山东理工大学：<a target="_blank" rel="noopener" href="http://pypi.sdutlinux.org/">http://pypi.sdutlinux.org/</a> </p>
<p>豆瓣：<a target="_blank" rel="noopener" href="http://pypi.douban.com/simple/">http://pypi.douban.com/simple/</a></p>
<p>临时使用：</p>
<p>可以在使用pip的时候加参数-i <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>例如：pip install -i <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a> pyspider，这样就会从清华这边的镜像去安装pyspider库。</p>
<p>永久修改：</p>
<p>Linux下，修改 ~/.pip/pip.conf (没有就创建一个文件夹及文件。文件夹要加“.”，表示是隐藏文件夹)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url &#x3D; https:&#x2F;&#x2F;pypi.tuna.tsinghua.edu.cn&#x2F;simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host&#x3D;mirrors.aliyun.com</span><br></pre></td></tr></table></figure>

<p>windows下，直接在user目录中创建一个pip目录，如：C:\Users\xx\pip，新建文件pip.ini。内容同上。</p>
<h2 id="用-pyinstaller-打包-python-脚本到可执行文件"><a href="#用-pyinstaller-打包-python-脚本到可执行文件" class="headerlink" title="用 pyinstaller 打包 python 脚本到可执行文件"></a>用 pyinstaller 打包 python 脚本到可执行文件</h2><p><a target="_blank" rel="noopener" href="https://jingyan.baidu.com/article/a378c960b47034b3282830bb.html">https://jingyan.baidu.com/article/a378c960b47034b3282830bb.html</a></p>
<p>安装 pyinstaller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pyinstaller</span><br></pre></td></tr></table></figure>

<p>打包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller -F your.py</span><br></pre></td></tr></table></figure>

<p><strong>注意：用 -D 来打包到一个目录，运行速度会比 -F 打包到一个 .exe 快。</strong></p>
<h2 id="用-spec-files-打包"><a href="#用-spec-files-打包" class="headerlink" title="用 spec files 打包"></a>用 spec files 打包</h2><p><a target="_blank" rel="noopener" href="https://pyinstaller.readthedocs.io/en/v3.3.1/spec-files.html">https://pyinstaller.readthedocs.io/en/v3.3.1/spec-files.html</a></p>
<p>命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller master.spec</span><br></pre></td></tr></table></figure>

<h2 id="打包资源文件"><a href="#打包资源文件" class="headerlink" title="打包资源文件"></a>打包资源文件</h2><p><a target="_blank" rel="noopener" href="https://pythonhosted.org/PyInstaller/runtime-information.html#run-time-information">https://pythonhosted.org/PyInstaller/runtime-information.html#run-time-information</a></p>
<p><a target="_blank" rel="noopener" href="https://pythonhosted.org/PyInstaller/operating-mode.html#how-the-one-file-program-works">https://pythonhosted.org/PyInstaller/operating-mode.html#how-the-one-file-program-works</a></p>
<p>有时需要打包一些资源文件，比如图片，音乐，或者可执行文件，需要用 —add-data 选项。</p>
<p>需要注意的是，打包后的可执行文件的工作原理其实是在 /tmp 目录下创建了临时工作文件夹 __MEI<em>xxxxxx</em> ，</p>
<p>资源文件都是放在此文件夹内的，所以脚本中使用资源文件就必须使用此临时文件夹的路径：<code>sys._MEIPASS</code></p>
<h2 id="Pyinstaller-和-import"><a href="#Pyinstaller-和-import" class="headerlink" title="Pyinstaller 和 __import__"></a>Pyinstaller 和 __import__</h2><p><code>__import__</code>可以动态导入模块，在用 pyinstaller 打包时，要把所有可能被导入的模块用 –hidden-import 选项加入进去，否则打包的程序运行时会找不到这些模块。</p>
<h2 id="pip-查看已经安装的包及路径"><a href="#pip-查看已经安装的包及路径" class="headerlink" title="pip 查看已经安装的包及路径"></a>pip 查看已经安装的包及路径</h2><p><a target="_blank" rel="noopener" href="http://me.iblogc.com/2015/01/01/pip%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4">pip常用命令</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">显示包所在的目录</span><br><span class="line"></span><br><span class="line">pip show -f &lt;包名&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Pycharm-PyQt5-Qt5-开发"><a href="#Pycharm-PyQt5-Qt5-开发" class="headerlink" title="Pycharm + PyQt5 + Qt5 开发"></a>Pycharm + PyQt5 + Qt5 开发</h2><h3 id="安装-pyqt5"><a href="#安装-pyqt5" class="headerlink" title="安装 pyqt5"></a>安装 pyqt5</h3><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/51562598">https://www.zhihu.com/question/51562598</a></p>
<p>用 pip 来安装 pyqt5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pyqt5</span><br></pre></td></tr></table></figure>

<h3 id="安装-Qt5"><a href="#安装-Qt5" class="headerlink" title="安装 Qt5"></a>安装 Qt5</h3><p><a target="_blank" rel="noopener" href="http://download.qt.io/official_releases/qt/">http://download.qt.io/official_releases/qt/</a></p>
<p>下载 5.10.1 版本</p>
<h3 id="配置-PyCharm"><a href="#配置-PyCharm" class="headerlink" title="配置 PyCharm"></a>配置 PyCharm</h3><p><a target="_blank" rel="noopener" href="http://gavinliu.cn/2016/01/17/Python-Mac%E4%B8%8BPyCharm-PyQt5%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">Python - Mac下PyQt5环境搭建</a></p>
<h3 id="信号和槽"><a href="#信号和槽" class="headerlink" title="信号和槽"></a>信号和槽</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhulove86/article/details/52530214">https://blog.csdn.net/zhulove86/article/details/52530214</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a359680405/article/details/45148717">https://blog.csdn.net/a359680405/article/details/45148717</a></p>
<h3 id="子线程操作-UI"><a href="#子线程操作-UI" class="headerlink" title="子线程操作 UI"></a>子线程操作 UI</h3><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/37334646">为什么大多数程序子线程都不能刷新UI？</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/AhdaiMolly/article/details/74376525">https://blog.csdn.net/AhdaiMolly/article/details/74376525</a></p>
<p><a target="_blank" rel="noopener" href="https://www.2cto.com/kf/201703/608163.html">https://www.2cto.com/kf/201703/608163.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.v2ex.com/t/346882">https://www.v2ex.com/t/346882</a></p>
<blockquote>
<p>signal = pyqtSignal(str)<br>signal.connect(update) # Main thread<br>signal.emit(value) # sub thread</p>
</blockquote>
<p>UI 线程和 worker 线程之间只能通过 signal 来通信</p>
<p>worker 线程通过 emit signal 来操作 UI。</p>
<p>UI 线程通过 signal connect 的函数来实现回调。</p>
<h3 id="去除标题栏"><a href="#去除标题栏" class="headerlink" title="去除标题栏"></a>去除标题栏</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/codeAB/p/5019439.html">https://www.cnblogs.com/codeAB/p/5019439.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QWidget.setWindowFlags(Qt.FramelessWindowHint)</span><br></pre></td></tr></table></figure>

<h3 id="全屏"><a href="#全屏" class="headerlink" title="全屏"></a>全屏</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QWidget.showFullScreen()</span><br></pre></td></tr></table></figure>

<h3 id="BOX-layout-和-Grid-layout"><a href="#BOX-layout-和-Grid-layout" class="headerlink" title="BOX layout 和 Grid layout"></a>BOX layout 和 Grid layout</h3><h3 id="QThread"><a href="#QThread" class="headerlink" title="QThread"></a>QThread</h3><p>最好不要用 QThread</p>
<p><a target="_blank" rel="noopener" href="http://hgoldfish.com/blogs/article/80/">http://hgoldfish.com/blogs/article/80/</a></p>
<p><a target="_blank" rel="noopener" href="http://www.hgoldfish.com/blogs/article/97/">http://www.hgoldfish.com/blogs/article/97/</a></p>
<h3 id="Progress-bar"><a href="#Progress-bar" class="headerlink" title="Progress bar"></a>Progress bar</h3><p>Progress bar 的高度是由字体决定的</p>
<h3 id="鼠标双击事件"><a href="#鼠标双击事件" class="headerlink" title="鼠标双击事件"></a>鼠标双击事件</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dxt1107/article/details/47806965">https://blog.csdn.net/dxt1107/article/details/47806965</a></p>
<p>为了响应双击QLabel的事件，需要重写QWidget的mouseDoubleClickEvent方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from PyQt4.QtGui import *</span><br><span class="line">from PyQt4.QtCore import *</span><br><span class="line">from PyQt4 import *</span><br><span class="line">class MyLabel(QtGui.QLabel):</span><br><span class="line">    def __init__(self,parent&#x3D;None):</span><br><span class="line">        super(MyLabel,self).__init__(parent)</span><br><span class="line">    def mouseDoubleClickEvent(self,e):</span><br><span class="line">        print &#39;mouse double clicked&#39;   </span><br><span class="line">    def mousePressEvent(self,e):</span><br><span class="line">        print &#39;mousePressEvent&#39;</span><br><span class="line">    def focusInEvent(self,e):</span><br><span class="line">        print &#39;focusInEvent&#39;</span><br><span class="line">    def focusOutEvent(self,e):</span><br><span class="line">        print &#39;focusOutEvent&#39;</span><br><span class="line">    def moveEvent(self,e):</span><br><span class="line">        print &#39;moveEvent&#39;</span><br><span class="line">    def leaveEvent(self,e): #鼠标离开label</span><br><span class="line">        print &#39;leaveEvent&#39;</span><br><span class="line">    def enterEvent(self,e): #鼠标移入label</span><br><span class="line">        print &#39;enterEvent&#39;</span><br><span class="line">    def mouseMoveEvent(self,e):</span><br><span class="line">        print &#39;mouseMoveEvent&#39;</span><br><span class="line"> </span><br><span class="line">class TestDialog(QtGui.QDialog):</span><br><span class="line">    def __init__(self,parent&#x3D;None):</span><br><span class="line">        super(TestDialog,self).__init__(parent)</span><br><span class="line">        self.statusLabel &#x3D; MyLabel(self)</span><br><span class="line">        self.statusLabel.setGeometry(QtCore.QRect(95, 220, 151, 41))</span><br><span class="line">        self.statusLabel.setText(&quot;hello label&quot;)</span><br><span class="line"> </span><br><span class="line">app&#x3D;QApplication(sys.argv)</span><br><span class="line">dialog&#x3D;TestDialog()</span><br><span class="line">dialog.show()</span><br></pre></td></tr></table></figure>

<h3 id="PyQt5-Qt-designer-开发"><a href="#PyQt5-Qt-designer-开发" class="headerlink" title="PyQt5 + Qt designer 开发"></a>PyQt5 + Qt designer 开发</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chlk118/article/details/72595325">https://blog.csdn.net/chlk118/article/details/72595325</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yy123xiang/article/details/78681669">https://blog.csdn.net/yy123xiang/article/details/78681669</a></p>
<p>用 Qt designer 生成的 .ui 文件，无需转换成 .py 文件，可以直接用 PyQt5.uic.loadUi 方法来加载。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QApplication, QMainWindow</span><br><span class="line">from PyQt5.uic import loadUi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MainWindow(QMainWindow):</span><br><span class="line">    def __init__(self, parent&#x3D;None):</span><br><span class="line">        super(MainWindow, self).__init__(parent)</span><br><span class="line">        loadUi(&#39;pyflashloader_isp.ui&#39;, self)</span><br><span class="line">        self.setFixedSize(self.sizeHint())</span><br><span class="line"></span><br><span class="line">app &#x3D; QApplication(sys.argv)</span><br><span class="line">w &#x3D; MainWindow()</span><br><span class="line">w.show()</span><br><span class="line">sys.exit(app.exec())</span><br></pre></td></tr></table></figure>

<h3 id="文件打开保存框"><a href="#文件打开保存框" class="headerlink" title="文件打开保存框"></a>文件打开保存框</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a359680405/article/details/45166271">https://blog.csdn.net/a359680405/article/details/45166271</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">from PyQt5 import QtWidgets</span><br><span class="line">from PyQt5.QtWidgets import QFileDialog</span><br><span class="line"></span><br><span class="line">class MyWindow(QtWidgets.QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(MyWindow,self).__init__()</span><br><span class="line">        self.myButton &#x3D; QtWidgets.QPushButton(self)</span><br><span class="line">        self.myButton.setObjectName(&quot;myButton&quot;)</span><br><span class="line">        self.myButton.setText(&quot;Test&quot;)</span><br><span class="line">        self.myButton.clicked.connect(self.msg)</span><br><span class="line"></span><br><span class="line">    def msg(self):</span><br><span class="line">        directory1 &#x3D; QFileDialog.getExistingDirectory(self,</span><br><span class="line">                                    &quot;选取文件夹&quot;,</span><br><span class="line">                                    &quot;C:&#x2F;&quot;)                                 #起始路径</span><br><span class="line">        print(directory1)</span><br><span class="line"></span><br><span class="line">        fileName1, filetype &#x3D; QFileDialog.getOpenFileName(self,</span><br><span class="line">                                    &quot;选取文件&quot;,</span><br><span class="line">                                    &quot;C:&#x2F;&quot;,</span><br><span class="line">                                    &quot;All Files (*);;Text Files (*.txt)&quot;)   #设置文件扩展名过滤,注意用双分号间隔</span><br><span class="line">        print(fileName1,filetype)</span><br><span class="line"></span><br><span class="line">        files, ok1 &#x3D; QFileDialog.getOpenFileNames(self,</span><br><span class="line">                                    &quot;多文件选择&quot;,</span><br><span class="line">                                    &quot;C:&#x2F;&quot;,</span><br><span class="line">                                    &quot;All Files (*);;Text Files (*.txt)&quot;)</span><br><span class="line">        print(files,ok1)</span><br><span class="line"></span><br><span class="line">        fileName2, ok2 &#x3D; QFileDialog.getSaveFileName(self,</span><br><span class="line">                                    &quot;文件保存&quot;,</span><br><span class="line">                                    &quot;C:&#x2F;&quot;,</span><br><span class="line">                                    &quot;All Files (*);;Text Files (*.txt)&quot;)</span><br><span class="line"></span><br><span class="line">if __name__&#x3D;&#x3D;&quot;__main__&quot;:  </span><br><span class="line">    import sys  </span><br><span class="line">  </span><br><span class="line">    app&#x3D;QtWidgets.QApplication(sys.argv)  </span><br><span class="line">    myshow&#x3D;MyWindow()</span><br><span class="line">    myshow.show()</span><br><span class="line">    sys.exit(app.exec_())  </span><br></pre></td></tr></table></figure>

<h3 id="QWidget-背景透明"><a href="#QWidget-背景透明" class="headerlink" title="QWidget 背景透明"></a>QWidget 背景透明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.setWindowFlag(Qt.FramelessWindowHint)</span><br><span class="line">self.setStyleSheet(&#39;background_color:rgba(255,255,255,128)&#39;)</span><br></pre></td></tr></table></figure>

<p>其中 FramelessWindowHint 是必须的，没有这个 Flag，背景就不是透明的。</p>
<h3 id="PushButton-对齐边界"><a href="#PushButton-对齐边界" class="headerlink" title="PushButton 对齐边界"></a>PushButton 对齐边界</h3><p>PushButton 比较奇怪，放在布局内也会超出一截造成不对齐，所以要单独放在一个布局内，再放入布局内。</p>
<p>比如，先把 pushbutton 放在 vertical layout 内，然后再放在 Grid layout 内，就边界对齐了。</p>
<h2 id="获取本机-MAC-地址"><a href="#获取本机-MAC-地址" class="headerlink" title="获取本机 MAC 地址"></a>获取本机 MAC 地址</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chenjingyi/p/5741742.html">https://www.cnblogs.com/chenjingyi/p/5741742.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import uuid</span><br><span class="line">def get_mac_address(): </span><br><span class="line">    mac&#x3D;uuid.UUID(int &#x3D; uuid.getnode()).hex[-12:] </span><br><span class="line">    return &quot;:&quot;.join([mac[e:e+2] for e in range(0,11,2)])</span><br></pre></td></tr></table></figure>

<p>需要注意的是，多网卡的机器，此方法返回的 MAC 可能不是固定的。</p>
<h2 id="AES-加密"><a href="#AES-加密" class="headerlink" title="AES 加密"></a>AES 加密</h2><p>安装 Crypto 库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pycrypto</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/nurke/article/details/77267081">https://blog.csdn.net/nurke/article/details/77267081</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#coding: utf8</span><br><span class="line">import sys</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from binascii import b2a_hex, a2b_hex</span><br><span class="line"> </span><br><span class="line">class prpcrypt():</span><br><span class="line">    def __init__(self, key):</span><br><span class="line">        self.key &#x3D; key</span><br><span class="line">        self.mode &#x3D; AES.MODE_CBC</span><br><span class="line">     </span><br><span class="line">    #加密函数，如果text不是16的倍数【加密文本text必须为16的倍数！】，那就补足为16的倍数</span><br><span class="line">    def encrypt(self, text):</span><br><span class="line">        cryptor &#x3D; AES.new(self.key, self.mode, self.key)</span><br><span class="line">        #这里密钥key 长度必须为16（AES-128）、24（AES-192）、或32（AES-256）Bytes 长度.目前AES-128足够用</span><br><span class="line">        length &#x3D; 16</span><br><span class="line">        count &#x3D; len(text)</span><br><span class="line">	if(count % length !&#x3D; 0) :</span><br><span class="line">        	add &#x3D; length - (count % length)</span><br><span class="line">	else:</span><br><span class="line">		add &#x3D; 0</span><br><span class="line">        text &#x3D; text + (&#39;\0&#39; * add)</span><br><span class="line">        self.ciphertext &#x3D; cryptor.encrypt(text)</span><br><span class="line">        #因为AES加密时候得到的字符串不一定是ascii字符集的，输出到终端或者保存时候可能存在问题</span><br><span class="line">        #所以这里统一把加密后的字符串转化为16进制字符串</span><br><span class="line">        return b2a_hex(self.ciphertext)</span><br><span class="line">     </span><br><span class="line">    #解密后，去掉补足的空格用strip() 去掉</span><br><span class="line">    def decrypt(self, text):</span><br><span class="line">        cryptor &#x3D; AES.new(self.key, self.mode, self.key)</span><br><span class="line">        plain_text &#x3D; cryptor.decrypt(a2b_hex(text))</span><br><span class="line">        return plain_text.rstrip(&#39;\0&#39;)</span><br><span class="line"> </span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    pc &#x3D; prpcrypt(&#39;keyskeyskeyskeys&#39;)      #初始化密钥</span><br><span class="line">    e &#x3D; pc.encrypt(&quot;0123456789ABCDEF&quot;)</span><br><span class="line">    d &#x3D; pc.decrypt(e)                     </span><br><span class="line">    print e, d</span><br><span class="line">    e &#x3D; pc.encrypt(&quot;00000000000000000000000000&quot;)</span><br><span class="line">    d &#x3D; pc.decrypt(e)                  </span><br><span class="line">    print e, d</span><br></pre></td></tr></table></figure>

<h2 id="HASH-算法"><a href="#HASH-算法" class="headerlink" title="HASH 算法"></a>HASH 算法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import hashlib</span><br><span class="line">&gt;&gt;&gt; hashlib.sha256(&#39;123456789&#39;.encode()).hexdigest()</span><br><span class="line">&#39;15e2b0d3c33891ebb0f1ef609ec419420c20e320ce94c65fbc8c3312448eb225&#39;</span><br></pre></td></tr></table></figure>

<h2 id="程序退出-sys-exit-status"><a href="#程序退出-sys-exit-status" class="headerlink" title="程序退出 sys.exit(status)"></a>程序退出 sys.exit(status)</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/weiman3389/p/6047062.html">https://www.cnblogs.com/weiman3389/p/6047062.html</a></p>
<p>sys.exit(status) 的参数 status 就是此代码的执行结果，可以用 subprocess 来捕捉。</p>
<h2 id="移动-删除文件"><a href="#移动-删除文件" class="headerlink" title="移动/删除文件"></a>移动/删除文件</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/woshisangsang/article/details/74360612">https://blog.csdn.net/woshisangsang/article/details/74360612</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#文件、文件夹的移动、复制、删除、重命名</span><br><span class="line"></span><br><span class="line">#导入shutil模块和os模块</span><br><span class="line">import shutil,os</span><br><span class="line"></span><br><span class="line">#复制单个文件</span><br><span class="line">shutil.copy(&quot;C:\\a\\1.txt&quot;,&quot;C:\\b&quot;)</span><br><span class="line">#复制并重命名新文件</span><br><span class="line">shutil.copy(&quot;C:\\a\\2.txt&quot;,&quot;C:\\b\\121.txt&quot;)</span><br><span class="line">#复制整个目录(备份)</span><br><span class="line">shutil.copytree(&quot;C:\\a&quot;,&quot;C:\\b\\new_a&quot;)</span><br><span class="line"></span><br><span class="line">#删除文件</span><br><span class="line">os.unlink(&quot;C:\\b\\1.txt&quot;)</span><br><span class="line">os.unlink(&quot;C:\\b\\121.txt&quot;)</span><br><span class="line">#删除空文件夹</span><br><span class="line">try:</span><br><span class="line">    os.rmdir(&quot;C:\\b\\new_a&quot;)</span><br><span class="line">except Exception as ex:</span><br><span class="line">    print(&quot;错误信息：&quot;+str(ex))#提示：错误信息，目录不是空的</span><br><span class="line">#删除文件夹及内容</span><br><span class="line">shutil.rmtree(&quot;C:\\b\\new_a&quot;)</span><br><span class="line"></span><br><span class="line">#移动文件</span><br><span class="line">shutil.move(&quot;C:\\a\\1.txt&quot;,&quot;C:\\b&quot;)</span><br><span class="line">#移动文件夹</span><br><span class="line">shutil.move(&quot;C:\\a\\c&quot;,&quot;C:\\b&quot;)</span><br><span class="line"></span><br><span class="line">#重命名文件</span><br><span class="line">shutil.move(&quot;C:\\a\\2.txt&quot;,&quot;C:\\a\\new2.txt&quot;)</span><br><span class="line">#重命名文件夹</span><br><span class="line">shutil.move(&quot;C:\\a\\d&quot;,&quot;C:\\a\\new_d&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="threading"><a href="#threading" class="headerlink" title="threading"></a>threading</h2><p>daemon</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xfiver/p/5189732.html">https://www.cnblogs.com/xfiver/p/5189732.html</a></p>
<h2 id="获取本机-IP-地址"><a href="#获取本机-IP-地址" class="headerlink" title="获取本机 IP 地址"></a>获取本机 IP 地址</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40539892/article/details/79103254">https://blog.csdn.net/weixin_40539892/article/details/79103254</a></p>
<p>这个方法是目前见过最优雅获取本机服务器的IP方法了。没有任何的依赖，也没有去猜测机器上的网络设备信息。</p>
<p>而且是利用 UDP 协议来实现的，生成一个UDP包，把自己的 IP 放如到 UDP 协议头中，然后从UDP包中获取本机的IP。</p>
<p>这个方法并不会真实的向外部发包，所以用抓包工具是看不到的。但是会申请一个 UDP 的端口，所以如果经常调用也会比较耗时的，这里如果需要可以将查询到的IP给缓存起来，性能可以获得很大提升。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 在 shell 中可以一行调用，获取到本机IP</span><br><span class="line">python -c &quot;import socket;print([(s.connect((&#39;8.8.8.8&#39;, 53)), s.getsockname()[0], s.close()) for s in [socket.socket(socket.AF_INET, socket.SOCK_DGRAM)]][0][1])&quot;</span><br><span class="line">10.12.189.16</span><br><span class="line"># 可以封装成函数，方便 Python 的程序调用</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">def get_host_ip():</span><br><span class="line">    try:</span><br><span class="line">        s &#x3D; socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">        s.connect((&#39;8.8.8.8&#39;, 80))</span><br><span class="line">        ip &#x3D; s.getsockname()[0]</span><br><span class="line">    finally:</span><br><span class="line">        s.close()</span><br><span class="line"></span><br><span class="line">    return ip</span><br></pre></td></tr></table></figure>
<h2 id="requests-加了-timeout-为啥还是会卡住？"><a href="#requests-加了-timeout-为啥还是会卡住？" class="headerlink" title="requests 加了 timeout 为啥还是会卡住？"></a>requests 加了 timeout 为啥还是会卡住？</h2><p><a target="_blank" rel="noopener" href="https://www.v2ex.com/amp/t/365351">https://www.v2ex.com/amp/t/365351</a></p>
<blockquote>
<p>conn = request.urlopen(image_url,timeout=300)</p>
<p>请问有啥优化的办法么？</p>
<p>爬虫爬了 24 小时卡住了。。 重启启动以后又继续爬了</p>
<hr>
<p>requests 文档上有写<br>Note<br>timeout is not a time limit on the entire response download; rather, an exception is raised if the server has not issued a response for timeout seconds (more precisely, if no bytes have been received on the underlying socket for timeout seconds). If no timeout is specified explicitly, requests do not time out. </p>
<p>在最开始加一个<br>import socket<br>socket.setdefaulttimeout(时间)<br>就可以了</p>
</blockquote>
<h2 id="Python脚本生成的exe文件自动升级程序实现方法"><a href="#Python脚本生成的exe文件自动升级程序实现方法" class="headerlink" title="Python脚本生成的exe文件自动升级程序实现方法"></a>Python脚本生成的exe文件自动升级程序实现方法</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013193899/article/details/78686039">https://blog.csdn.net/u013193899/article/details/78686039</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import subprocess </span><br><span class="line"></span><br><span class="line">#编写bat脚本，删除旧程序，运行新程序</span><br><span class="line">def WriteRestartCmd(exe_name):</span><br><span class="line">    b &#x3D; open(&quot;upgrade.bat&quot;,&#39;w&#39;)</span><br><span class="line">    TempList &#x3D; &quot;@echo off\n&quot;;   #关闭bat脚本的输出</span><br><span class="line">    TempList +&#x3D; &quot;if not exist &quot;+exe_name+&quot; exit \n&quot;;    #新文件不存在,退出脚本执行</span><br><span class="line">    TempList +&#x3D; &quot;sleep 3\n&quot; #3秒后删除旧程序（3秒后程序已运行结束，不延时的话，会提示被占用，无法删除）</span><br><span class="line">    TempList +&#x3D; &quot;del &quot;+ os.path.realpath(sys.argv[0]) + &quot;\n&quot;    #删除当前文件</span><br><span class="line">    TempList +&#x3D; &quot;start &quot; + exe_name     #启动新程序</span><br><span class="line">    b.write(TempList)</span><br><span class="line">    b.close()</span><br><span class="line">    subprocess.Popen(&quot;upgrade.bat&quot;)</span><br><span class="line">    sys.exit()  #进行升级，退出此程序</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">#新程序启动时，删除旧程序制造的脚本</span><br><span class="line">    if os.path.isfile(&quot;upgrade.bat&quot;):</span><br><span class="line">        os.remove(&quot;upgrade.bat&quot;)</span><br><span class="line">    WriteRestartCmd(&quot;newVersion.exe&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br><span class="line">    sys.exit()1234567891011121314151617181920212223242526</span><br></pre></td></tr></table></figure>

<p>代码中不使用os.system()是因为 这个函数会阻塞，等待bat脚本操作完成后，才会继续执行。不适合此处场景</p>
<h2 id="搭建-Flask-服务系统"><a href="#搭建-Flask-服务系统" class="headerlink" title="搭建 Flask 服务系统"></a>搭建 Flask 服务系统</h2><p>pip3 install 安装如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Flask&#x3D;&#x3D;0.12.2</span><br><span class="line">Flask-Migrate&#x3D;&#x3D;2.1.1</span><br><span class="line">Flask-Script&#x3D;&#x3D;2.0.6</span><br><span class="line">Flask-SQLAlchemy&#x3D;&#x3D;2.3.2</span><br><span class="line">Flask-Uploads&#x3D;&#x3D;0.2.1</span><br><span class="line">Flask-WTF&#x3D;&#x3D;0.14.2</span><br></pre></td></tr></table></figure>

<h2 id="stdout-缓冲区问题"><a href="#stdout-缓冲区问题" class="headerlink" title="stdout 缓冲区问题"></a>stdout 缓冲区问题</h2><p>有时候 print 并不能实时打印出来，这时有两种方法：</p>
<ol>
<li><p>在 print 后加 sys.stdout.flush()</p>
</li>
<li><p>加个 python 选项 -u</p>
<p><strong>-u **Force stdin, stdout and stderr to be totally **unbuffered</strong>.  On systems where it matters, also put stdin,  stdout  and  stderr  in</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/joeblackzqq/article/details/7220009">https://blog.csdn.net/joeblackzqq/article/details/7220009</a></p>
<p>使用 Pyinstaller 打包时，可以在 .spec 的 options 内加入 -u 选项：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options &#x3D; [ (&#39;u&#39;, None, &#39;OPTION&#39;), ]</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://pyinstaller.readthedocs.io/en/v3.3.1/spec-files.html?highlight=-u">http://pyinstaller.readthedocs.io/en/v3.3.1/spec-files.html?highlight=-u</a></p>
<h2 id="Python-中-SSH-登录以及-SCP-传输文件"><a href="#Python-中-SSH-登录以及-SCP-传输文件" class="headerlink" title="Python 中 SSH 登录以及 SCP 传输文件"></a>Python 中 SSH 登录以及 SCP 传输文件</h2><p><strong>使用 paramiko 库来登录 SSH，使用 scp 来传输文件</strong></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/haigege/p/5513759.html">http://www.cnblogs.com/haigege/p/5513759.html</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.51cto.com/5ydycm/340854">http://blog.51cto.com/5ydycm/340854</a></p>
<p><a target="_blank" rel="noopener" href="http://docs.paramiko.org/en/2.4/">http://docs.paramiko.org/en/2.4/</a></p>
<p><a target="_blank" rel="noopener" href="https://pypi.org/project/scp">https://pypi.org/project/scp</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import paramiko</span><br><span class="line">from scp import SCPClient</span><br><span class="line"></span><br><span class="line">ssh &#x3D; paramiko.SSHClient()</span><br><span class="line">ssh.set_missing_host_key_policy(paramiko.client.MissingHostKeyPolicy)</span><br><span class="line">ssh.connect(&#39;192.168.3.40&#39;, username&#x3D;&#39;pi&#39;, password&#x3D;&#39;snowyang&#39;, timeout&#x3D;2)</span><br><span class="line"></span><br><span class="line">with SCPClient(ssh.get_transport()) as scp:</span><br><span class="line">    scp.get(&#39;&#x2F;home&#x2F;pi&#x2F;mx1290prog&#x2F;master.log&#39;, &#39;40.log&#39;)</span><br></pre></td></tr></table></figure>

<h2 id="GitPython"><a href="#GitPython" class="headerlink" title="GitPython"></a>GitPython</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/baiyangcao/p/gitpython.html">https://www.cnblogs.com/baiyangcao/p/gitpython.html</a></p>
<p><a target="_blank" rel="noopener" href="http://gitpython.readthedocs.io/en/stable/tutorial.html">http://gitpython.readthedocs.io/en/stable/tutorial.html</a></p>
<h2 id="错误-Text-file-busy"><a href="#错误-Text-file-busy" class="headerlink" title="错误:Text file busy"></a>错误:Text file busy</h2><p>在调试 B.A.T 烧录器客户端一拖三时发现有时烧录失败但是模组并没有断开，后来看 log 发现是调用 openocd 时发生了问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Info : stm32f4x.cpu: hardware has 6 breakpoints, 4 watchpoints</span><br><span class="line">Info : gdb server disabled</span><br><span class="line">shutdown command invoked</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">Disconnected</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">Disconnected</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">Disconnected</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: .&#x2F;openocd: Text file busy</span><br><span class="line">Open On-Chip Debugger 0.10.0+dev-00364-g1756f393 (2018-05-03-10:58)</span><br><span class="line">Licensed under GNU GPL v2</span><br></pre></td></tr></table></figure>

<p>起初怀疑是 openocd 不能多进程调用，后来才发现，其实是在烧录时我不小心 CTRL + S 对 .py 文件做了保存操作，也就是说在执行脚本时又写了此脚本，那么就会导致此错误。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1384398/usr-bin-perl-bad-interpreter-text-file-busy">https://stackoverflow.com/questions/1384398/usr-bin-perl-bad-interpreter-text-file-busy</a></p>
<h2 id="对象的生命周期"><a href="#对象的生命周期" class="headerlink" title="对象的生命周期"></a>对象的生命周期</h2><p>没有引用，对象就销毁了</p>
<p>一个引用在函数退出后就没有了</p>
<p>函数内的局部对象在退出后就销毁了</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/22a8bedc39fd">https://www.jianshu.com/p/22a8bedc39fd</a></p>
<h2 id="map-函数返回值问题"><a href="#map-函数返回值问题" class="headerlink" title="map 函数返回值问题"></a>map 函数返回值问题</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/kairen6645/article/details/80252824">https://blog.csdn.net/kairen6645/article/details/80252824</a></p>
<p>今天在使用python map的过程中，发现了一个奇怪问题，map遍历完成后，再次访问map，发现map为空了。</p>
<p>产生这种差异的原因在于：遍历完最后一个元素后，再次访问时会放回空列表。</p>
<p>所以要把 map 结果转换为 list 再返回：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m &#x3D; list(map(args))</span><br></pre></td></tr></table></figure>

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p><a target="_blank" rel="noopener" href="http://python.jobbole.com/82750/">Python奇技淫巧</a></p>
<h2 id="十六进制字符串转为十六进制数组。"><a href="#十六进制字符串转为十六进制数组。" class="headerlink" title="十六进制字符串转为十六进制数组。"></a>十六进制字符串转为十六进制数组。</h2><p>   比如把字符串 “ABCDEF” 转为 0xAB, 0xCD, 0xEF。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">usr&#x2F;bin&#x2F;python</span><br><span class="line"></span><br><span class="line">arr &#x3D; &quot;ABCDEF&quot;.decode(&#39;hex&#39;)</span><br><span class="line">f &#x3D; open(&#39;hex.bin&#39;, &#39;wb&#39;)</span><br><span class="line">f.write(arr)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
    </div>

    
    
    
        <div class="reward-container">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Snow Yang 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Snow Yang 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/11/Thinking/%E6%96%B0%E5%92%8C%E7%A8%B3/" rel="prev" title="新和稳">
      <i class="fa fa-chevron-left"></i> 新和稳
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/11/Programing%20Language/Python/pypi%20%E9%95%9C%E5%83%8F%E4%BD%BF%E7%94%A8%E5%B8%AE%E5%8A%A9/" rel="next" title="pypi 镜像使用帮助">
      pypi 镜像使用帮助 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.</span> <span class="nav-text">各种格式转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#39-0102-39-to-b-39-x01-x02-39"><span class="nav-number">1.1.</span> <span class="nav-text">&#39;0102&#39;  to  b&#39;\x01\x02&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-39-x01-x02-39-to-39-0102-39"><span class="nav-number">1.2.</span> <span class="nav-text">b&#39;\x01\x02&#39; to &#39;0102&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-39-x01-x02-39-to-1-2"><span class="nav-number">1.3.</span> <span class="nav-text">b&#39;\x01\x02&#39; to [1, 2]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-to-b-39-x01-x02-39"><span class="nav-number">1.4.</span> <span class="nav-text">[1, 2] to b&#39;\x01\x02&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-39-x31-x32-39-to-39-12-39"><span class="nav-number">1.5.</span> <span class="nav-text">b&#39;\x31\x32&#39; to &#39;12&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#39-12-39-to-b-39-x31-x32-39"><span class="nav-number">1.6.</span> <span class="nav-text">&#39;12&#39; to b&#39;\x31\x32&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1234-to-b-39-x12-x34-39"><span class="nav-number">1.7.</span> <span class="nav-text">0x1234 to b&#39;\x12\x34&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-39-x12-x34-39-to-0x1234"><span class="nav-number">1.8.</span> <span class="nav-text">b&#39;\x12\x34&#39; to 0x1234</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E5%AF%BC%E8%87%B4%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">2.</span> <span class="nav-text">中文字符导致的错误</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C%EF%BC%88%E6%88%90%E5%8A%9F-%E5%A4%B1%E8%B4%A5%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">获取命令行执行结果（成功&#x2F;失败）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%BB%E9%94%81"><span class="nav-number">3.1.</span> <span class="nav-text">死锁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96stdout"><span class="nav-number">3.2.</span> <span class="nav-text">读取stdout</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stdout-%E7%BC%93%E5%86%B2%E9%97%AE%E9%A2%98"><span class="nav-number">3.3.</span> <span class="nav-text">stdout 缓冲问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#subprocess-Popen-%E5%91%BD%E4%BB%A4%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">subprocess.Popen 命令类型详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#subprocess-run"><span class="nav-number">5.</span> <span class="nav-text">subprocess.run</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E5%A4%B9-os-walk"><span class="nav-number">6.</span> <span class="nav-text">遍历文件夹 - os.walk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%86%85%E6%BA%90%E6%9D%A5-pip-install"><span class="nav-number">7.</span> <span class="nav-text">使用国内源来 pip install</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-pyinstaller-%E6%89%93%E5%8C%85-python-%E8%84%9A%E6%9C%AC%E5%88%B0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="nav-number">8.</span> <span class="nav-text">用 pyinstaller 打包 python 脚本到可执行文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8-spec-files-%E6%89%93%E5%8C%85"><span class="nav-number">9.</span> <span class="nav-text">用 spec files 打包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-number">10.</span> <span class="nav-text">打包资源文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pyinstaller-%E5%92%8C-import"><span class="nav-number">11.</span> <span class="nav-text">Pyinstaller 和 __import__</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pip-%E6%9F%A5%E7%9C%8B%E5%B7%B2%E7%BB%8F%E5%AE%89%E8%A3%85%E7%9A%84%E5%8C%85%E5%8F%8A%E8%B7%AF%E5%BE%84"><span class="nav-number">12.</span> <span class="nav-text">pip 查看已经安装的包及路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pycharm-PyQt5-Qt5-%E5%BC%80%E5%8F%91"><span class="nav-number">13.</span> <span class="nav-text">Pycharm + PyQt5 + Qt5 开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-pyqt5"><span class="nav-number">13.1.</span> <span class="nav-text">安装 pyqt5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-Qt5"><span class="nav-number">13.2.</span> <span class="nav-text">安装 Qt5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-PyCharm"><span class="nav-number">13.3.</span> <span class="nav-text">配置 PyCharm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD"><span class="nav-number">13.4.</span> <span class="nav-text">信号和槽</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E7%BA%BF%E7%A8%8B%E6%93%8D%E4%BD%9C-UI"><span class="nav-number">13.5.</span> <span class="nav-text">子线程操作 UI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%BB%E9%99%A4%E6%A0%87%E9%A2%98%E6%A0%8F"><span class="nav-number">13.6.</span> <span class="nav-text">去除标题栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%8F"><span class="nav-number">13.7.</span> <span class="nav-text">全屏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BOX-layout-%E5%92%8C-Grid-layout"><span class="nav-number">13.8.</span> <span class="nav-text">BOX layout 和 Grid layout</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#QThread"><span class="nav-number">13.9.</span> <span class="nav-text">QThread</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Progress-bar"><span class="nav-number">13.10.</span> <span class="nav-text">Progress bar</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BC%A0%E6%A0%87%E5%8F%8C%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="nav-number">13.11.</span> <span class="nav-text">鼠标双击事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PyQt5-Qt-designer-%E5%BC%80%E5%8F%91"><span class="nav-number">13.12.</span> <span class="nav-text">PyQt5 + Qt designer 开发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%89%93%E5%BC%80%E4%BF%9D%E5%AD%98%E6%A1%86"><span class="nav-number">13.13.</span> <span class="nav-text">文件打开保存框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#QWidget-%E8%83%8C%E6%99%AF%E9%80%8F%E6%98%8E"><span class="nav-number">13.14.</span> <span class="nav-text">QWidget 背景透明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PushButton-%E5%AF%B9%E9%BD%90%E8%BE%B9%E7%95%8C"><span class="nav-number">13.15.</span> <span class="nav-text">PushButton 对齐边界</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BA-MAC-%E5%9C%B0%E5%9D%80"><span class="nav-number">14.</span> <span class="nav-text">获取本机 MAC 地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AES-%E5%8A%A0%E5%AF%86"><span class="nav-number">15.</span> <span class="nav-text">AES 加密</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HASH-%E7%AE%97%E6%B3%95"><span class="nav-number">16.</span> <span class="nav-text">HASH 算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E9%80%80%E5%87%BA-sys-exit-status"><span class="nav-number">17.</span> <span class="nav-text">程序退出 sys.exit(status)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A7%BB%E5%8A%A8-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="nav-number">18.</span> <span class="nav-text">移动&#x2F;删除文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#threading"><span class="nav-number">19.</span> <span class="nav-text">threading</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BA-IP-%E5%9C%B0%E5%9D%80"><span class="nav-number">20.</span> <span class="nav-text">获取本机 IP 地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#requests-%E5%8A%A0%E4%BA%86-timeout-%E4%B8%BA%E5%95%A5%E8%BF%98%E6%98%AF%E4%BC%9A%E5%8D%A1%E4%BD%8F%EF%BC%9F"><span class="nav-number">21.</span> <span class="nav-text">requests 加了 timeout 为啥还是会卡住？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python%E8%84%9A%E6%9C%AC%E7%94%9F%E6%88%90%E7%9A%84exe%E6%96%87%E4%BB%B6%E8%87%AA%E5%8A%A8%E5%8D%87%E7%BA%A7%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95"><span class="nav-number">22.</span> <span class="nav-text">Python脚本生成的exe文件自动升级程序实现方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA-Flask-%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F"><span class="nav-number">23.</span> <span class="nav-text">搭建 Flask 服务系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#stdout-%E7%BC%93%E5%86%B2%E5%8C%BA%E9%97%AE%E9%A2%98"><span class="nav-number">24.</span> <span class="nav-text">stdout 缓冲区问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-%E4%B8%AD-SSH-%E7%99%BB%E5%BD%95%E4%BB%A5%E5%8F%8A-SCP-%E4%BC%A0%E8%BE%93%E6%96%87%E4%BB%B6"><span class="nav-number">25.</span> <span class="nav-text">Python 中 SSH 登录以及 SCP 传输文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GitPython"><span class="nav-number">26.</span> <span class="nav-text">GitPython</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%94%99%E8%AF%AF-Text-file-busy"><span class="nav-number">27.</span> <span class="nav-text">错误:Text file busy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">28.</span> <span class="nav-text">对象的生命周期</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map-%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E9%97%AE%E9%A2%98"><span class="nav-number">29.</span> <span class="nav-text">map 函数返回值问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">30.</span> <span class="nav-text">其他</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E4%B8%BA%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E6%95%B0%E7%BB%84%E3%80%82"><span class="nav-number">31.</span> <span class="nav-text">十六进制字符串转为十六进制数组。</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Snow Yang"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Snow Yang</p>
  <div class="site-description" itemprop="description">千古风流今在此，万里功名莫放休</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/smartsnow" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;smartsnow" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Snow Yang</span>
</div>
  <!-- <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
  -->

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"PV6nn46hGfP8NYx7WwzusM8C-9Nh9j0Va","app_key":"icEREPKf8nKewGksI1Nw6KrM","server_url":null,"security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
